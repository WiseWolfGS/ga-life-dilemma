아래 체크리스트는 **README의 요구사항을 MVP 기준으로 쪼개고, pnpm 모노레포 구조에 맞게 재분류**한 개발 계획서입니다.

---

## 🎯 MVP 목표

**“시드 고정 및 파라미터 설정이 가능한 상태에서, 동기 업데이트되는 CA+GA 시뮬레이션이 안정적으로 실행(tick)되어야 한다. 그 결과는 Canvas를 통해 3종의 맵(유전자, 지형, 확률)으로 렌더링되며, 핵심 통계(밀도, 생존/사망 수)를 제공하고, 현재 설정을 JSON 파일로 저장하고 불러올 수 있어야 한다.”**

---

### 🚫 MVP 제외 범위

*   [ ] **‘죄수의 딜레마’ 기능 제외**
    *   **완료 정의:** 코드/데이터 구조에 `strategy` 슬롯 정도만 예약해두고, 실제 게임 이론 관련 로직은 구현하지 않는다.

---

## 📦 패키지별 체크리스트

### 🔵 `packages/core` (순수 시뮬레이션 엔진)

> React나 브라우저 API에 의존하지 않는 순수 TypeScript 로직입니다.

#### 1. 코어 엔진 (CA + 확률 규칙 + 동기 업데이트)

*   [ ] **격자/경계/상태 모델**
    *   **2D 직사각 격자 + 토러스 경계:** 이웃 조회 시 인덱스 에러 없이 wrap-around. (단위 테스트)
    *   **셀 상태 `alive/dead` + 형태 유전자 `[U,D,L,R]`:** `alive` 셀은 항상 유전자를 가짐. `dead` 셀의 유전자 정책은 문서화.
*   [ ] **영향력 전파 규칙**
    *   **유전자 값 도메인 `{2,4,6,8,10}` 강제:** 어떤 경로로든 이 집합 밖의 값이 생성되지 않음. (assert/단위 테스트)
    *   **상하좌우/대각선 영향력 계산:** README의 예시 `[10,4,6,8]`에 대한 3x3 영향력 매트릭스 재현. (단위 테스트)
    *   **영향력 합산 그리드 `influence_grid` 계산:** `tick`마다 0으로 초기화 후, 모든 `alive` 셀의 기여를 주변 8칸에 누적.
    *   **반올림 규칙 명시:** 영향력 계산 시 소수점 반올림 위치를 결정하고(추천: `S_total` 최종값) 일관되게 구현.
*   [ ] **생존/탄생 확률 모델**
    *   **`p_live` / `p_born` 구현:** 로지스틱 함수 기반, 파라미터(α,β,γ,μ,ν,δ) 입력 시 결과는 항상 `[0,1]` 범위. (단위 테스트)
    *   **`epsilon` 컷오프:** `p < ε` 이면 0으로 처리.
    *   **탄생 조건:** 주변 8칸에 `alive` 셀이 1개 이상일 때만 탄생 가능. (단위 테스트)
    *   **초기 밀도 `ρ=0.25`:** 기본 초기화 시 `alive` 비율이 통계적으로 0.25에 수렴.
*   [ ] **동기 업데이트 (Tick 파이프라인)**
    *   **`tick` 3단계 (영향합산 → 판정/자손생성 → 동기커밋):** 다음 세대 상태를 계산하는 동안 현재 세대 상태가 변경되지 않음. (불변성 또는 더블 버퍼링)

#### 2. 유전 알고리즘 (GA)

*   [ ] **초기화 모드 4종:** 정규분포, 동일확률, 극단강화, 모두 `[6,6,6,6]`.
*   [ ] **부모 선택**
    *   **후보:** 탄생 칸 주변 8칸의 `alive` 셀.
    *   **적합도 정의:** 후보 셀이 '자기 위치에서' 받는 `S_total`로 `p_live`를 계산하여 적합도로 사용. (정의 확정 및 문서화)
    *   **확률적 선택:** 적합도가 높은 후보가 통계적으로 더 자주 선택됨.
*   [ ] **교차 모드 2종:** `50/50 locus-wise`, `주변 24칸 다수결`.
    > ⚠️ "24칸 다수결" 정의: MVP에서는 'Moore radius=2에서 중심 제외 24칸'으로 고정하고 문서화.
*   [ ] **변이 모드 2종:** `부분 변이(locus-wise)`, `전체 변이(4개 모두 재샘플)`.

#### 3. 지형/환경 (최소 구현)

*   [ ] **지형(Terrain):** 영향력 `2x` / `0.5x` 지형.
*   [ ] **환경(Environment):** `항상 생존` / `항상 사망` / `강제 변이` / `추가 자원(+0.1 δ)` / `노이즈(δ 랜덤)`.
    > ⚠️ "높낮이 지형"은 수식 정의가 필요하므로 MVP 이후로 연기.

#### 4. 통계 및 재현성

*   [ ] **통계 로직:** `밀도(ρ)`, `세대별 탄생/사망 수`, `평균 수명` 계산 로직 구현.
*   [ ] **재현성 로직:** 시드 기반 RNG, 상태 해시 생성 기능.

---

### 🟢 `apps/web` (UI 및 렌더링)

> `packages/core`를 라이브러리로 가져와 사용하며, 사용자에게 보여주는 부분을 담당합니다.

#### 5. 파라미터 및 설정 시스템

*   [ ] **파라미터 구조체:** 핵심 파라미터(α,β,γ,μ,ν,δ,ε,p_mut)를 자료구조로 관리.
*   [ ] **UI 컨트롤:** `ParamPanel` 컴포넌트에서 파라미터 값을 실시간으로 변경.
*   [ ] **설정 저장/불러오기:** 시드, 파라미터, 활성 모드 등을 포함한 전체 설정을 JSON으로 저장하고 불러오는 기능.

#### 6. 렌더링 및 브리지

*   [ ] **엔진 브리지:** `packages/core`의 순수 TS 엔진을 감싸서 사용하는 `engine-js.ts` 구현.
    > ⚠️ WASM은 MVP 이후 목표이므로, `engine-wasm.ts`은 구조만 남겨둡니다. "복사 없는 구조"는 WASM 도입 시의 요구사항.
*   [ ] **메인 화면 및 조작 UI:**
    *   `Run/Pause`, `Step`, `Reset` 버튼.
    *   `Seed` 입력 필드.
*   [ ] **Canvas 렌더링 (`SimCanvas.tsx`)**
    *   **뷰 모드 3종 전환:** `형태 유전자 맵`, `지형&환경 맵`, `확률 맵`을 선택하여 렌더링.

#### 7. 통계 표시

*   [ ] **통계 패널:** `packages/core`에서 계산된 통계(`ρ`, `births/deaths` 등)를 UI에 실시간으로 표시.

---

## ✅ 최종 통합 테스트

> 아래 3가지 시나리오가 통과되면 MVP가 완료됩니다.

1.  **동기성 테스트:** `tick` 실행 전후로 `current`와 `next` 상태가 섞이지 않음을 확인.
2.  **재현성 테스트:** 동일한 `시드`와 `설정`으로 N틱 후, 상태 해시가 항상 동일함을 확인.
3.  **관측성 테스트:** 3종 뷰(유전자/지형/확률)와 핵심 통계가 UI에 동시에 정상적으로 표시되고 업데이트됨을 확인.
